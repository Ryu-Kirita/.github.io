<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="canvas">

    <!-- 会話開始の日付 -->
    <div class="conversation-date">2025/10/21</div>

    <!-- Pair 1 -->
    <section class="pair">

        <!-- 写真（相手） -->
        <div class="message-row message-row-left">
            <div class="avatar avatar-left">
                <img src="icons/other.jpeg" alt="">
            </div>

            <div class="message-wrapper-left">
                <div class="message message-photo">
                    <div class="photo-wrapper">
                        <img src="images/photo1.jpeg" class="photo" alt="">
                    </div>
                </div>
                <div class="bubble-time-outside bubble-time-outside-right">14:11</div>
            </div>
        </div>

        <!-- 音（自分） -->
        <div class="conversation-date">2025/10/23</div>
        <div class="message-row message-row-right">

            <div class="message-wrapper-right">
                <div class="message message-sound">
                    <div class="sound-wrapper">

                        <!-- 再生ボタン -->
                        <button class="sound-orb" data-audio="audio1">
                            <span class="orb-core"></span>
                            <span class="orb-ring"></span>
                        </button>

                        <!-- 波形（固定表示） -->
                        <div class="waveform" data-wave="audio1">
                            <span></span><span></span><span></span><span></span><span></span>
                            <span></span><span></span><span></span><span></span><span></span>
                        </div>

                        <!-- 進行バー -->
                        <div class="sound-progress" data-audio="audio1">
                            <div class="sound-progress-fill" data-progress="audio1"></div>
                        </div>

                        <audio id="audio1" src="music/music1.mp3"></audio>
                    </div>
                </div>

                <div class="bubble-time-outside bubble-time-outside-left">23:00</div>
            </div>

            <div class="avatar avatar-right">
                <img src="icons/me.jpeg" alt="">
            </div>
        </div>

    </section>


    <!-- Pair 2 -->
    <div class="conversation-date">2025/11/4</div>
    <section class="pair">

        <div class="message-row message-row-left">
            <div class="avatar avatar-left">
                <img src="icons/other.jpeg" alt="">
            </div>
            <div class="message-wrapper-left">
                <div class="message message-photo">
                    <div class="photo-wrapper">
                        <img src="images/photo2.jpeg" class="photo" alt="">
                    </div>
                </div>
                <div class="bubble-time-outside bubble-time-outside-right">15:24</div>
            </div>
        </div>

        <div class="conversation-date">2025/11/6</div>
        <div class="message-row message-row-right">

            <div class="message-wrapper-right">
                <div class="message message-sound">
                    <div class="sound-wrapper">

                        <button class="sound-orb" data-audio="audio2">
                            <span class="orb-core"></span>
                            <span class="orb-ring"></span>
                        </button>

                        <div class="waveform" data-wave="audio2">
                            <span></span><span></span><span></span><span></span><span></span>
                            <span></span><span></span><span></span><span></span><span></span>
                        </div>

                        <div class="sound-progress" data-audio="audio2">
                            <div class="sound-progress-fill" data-progress="audio2"></div>
                        </div>

                        <audio id="audio2" src="music/music2.mp3"></audio>
                    </div>
                </div>

                <div class="bubble-time-outside bubble-time-outside-left">22:33</div>
            </div>

            <div class="avatar avatar-right">
                <img src="icons/me.jpeg" alt="">
            </div>
        </div>

    </section>


    <!-- Pair 3 -->
    <div class="conversation-date">2025/12/10</div>
    <section class="pair">

        <div class="message-row message-row-left">
            <div class="avatar avatar-left">
                <img src="icons/other.jpeg" alt="">
            </div>
            <div class="message-wrapper-left">
                <div class="message message-photo">
                    <div class="photo-wrapper">
                        <img src="images/photo3.jpeg" class="photo" alt="">
                    </div>
                </div>
                <div class="bubble-time-outside bubble-time-outside-right">13:02</div>
            </div>
        </div>

        <div class="conversation-date">2025/12/20</div>
        <div class="message-row message-row-right">
            <div class="message-wrapper-right">
                <div class="message message-sound">
                    <div class="sound-wrapper">

                        <button class="sound-orb" data-audio="audio3">
                            <span class="orb-core"></span>
                            <span class="orb-ring"></span>
                        </button>

                        <div class="waveform" data-wave="audio3">
                            <span></span><span></span><span></span><span></span><span></span>
                            <span></span><span></span><span></span><span></span><span></span>
                        </div>

                        <div class="sound-progress" data-audio="audio3">
                            <div class="sound-progress-fill" data-progress="audio3"></div>
                        </div>

                        <audio id="audio3" src="music/music3.mp3"></audio>
                    </div>
                </div>

                <div class="bubble-time-outside bubble-time-outside-left">23:48</div>
            </div>

            <div class="avatar avatar-right">
                <img src="icons/me.jpeg" alt="">
            </div>
        </div>

    </section>

    <!-- Pair 4 -->
    <section class="pair">

        <div class="message-row message-row-left">
            <div class="avatar avatar-left">
                <img src="icons/other.jpeg" alt="">
            </div>
            <div class="message-wrapper-left">
                <div class="message message-photo">
                    <div class="photo-wrapper">
                        <img src="images/photo4.jpeg" class="photo" alt="">
                    </div>
                </div>
                <div class="bubble-time-outside bubble-time-outside-right">21:44</div>
            </div>
        </div>

        <div class="message-row message-row-right">
            <div class="message-wrapper-right">
                <div class="message message-sound">
                    <div class="sound-wrapper">

                        <button class="sound-orb" data-audio="audio4">
                            <span class="orb-core"></span>
                            <span class="orb-ring"></span>
                        </button>

                        <div class="waveform" data-wave="audio4">
                            <span></span><span></span><span></span><span></span><span></span>
                            <span></span><span></span><span></span><span></span><span></span>
                        </div>

                        <div class="sound-progress" data-audio="audio4">
                            <div class="sound-progress-fill" data-progress="audio4"></div>
                        </div>

                        <audio id="audio4" src="music/music4.mp3"></audio>
                    </div>
                </div>

                <div class="bubble-time-outside bubble-time-outside-left">21:48</div>
            </div>

            <div class="avatar avatar-right">
                <img src="icons/me.jpeg" alt="">
            </div>
        </div>

        <!-- 入力中（相手） -->
        <div class="message-row message-row-left typing-row">
            <div class="avatar avatar-left">
                <img src="icons/other.jpeg" alt="">
            </div>

            <div class="message-wrapper-left">
                <div class="message message-typing">
                    <span class="typing-text">入力中</span><span class="typing-dots">.</span>
                </div>
            </div>
        </div>

    </section>

</div>

<!-- 画像モーダル -->
<div class="image-modal" id="image-modal">
    <div class="image-modal-backdrop"></div>
    <img id="modal-image" alt="">
</div>


<!-- ✅ JS：音声再生 + 進捗バー + シーク + 入力中ドット増減 -->
<script>
document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll(".sound-orb");

    buttons.forEach(btn => {
        const audioId = btn.dataset.audio;
        const audio = document.getElementById(audioId);
        const progressFill = document.querySelector(`[data-progress="${audioId}"]`);
        const progressBar = document.querySelector(`.sound-progress[data-audio="${audioId}"]`);

        // 再生/停止
        btn.addEventListener("click", () => {

            // 他の音声が鳴ってたら止める
            document.querySelectorAll("audio").forEach(a => {
                if (a !== audio) {
                    a.pause();
                    a.currentTime = 0;
                }
            });

            if (audio.paused) {
                audio.play();
            } else {
                audio.pause();
            }
        });

        // 再生終了時
        audio.addEventListener("ended", () => {
            progressFill.style.width = "0%";
        });

        // 進捗更新
        audio.addEventListener("timeupdate", () => {
            const percent = (audio.currentTime / audio.duration) * 100;
            progressFill.style.width = `${percent}%`;
        });

        // 進捗バークリックでシーク
        progressBar.addEventListener("click", (e) => {
            const rect = progressBar.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const ratio = clickX / rect.width;
            audio.currentTime = audio.duration * ratio;
        });
    });

    // ✅ 入力中「. → .. → ... → .」変化
    const dots = document.querySelector(".typing-dots");
    if (dots) {
        let count = 1;
        setInterval(() => {
            dots.textContent = ".".repeat(count);
            count = (count % 3) + 1;
        }, 400);
    }
});
</script>

</body>
</html>
